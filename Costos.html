<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BoviGestf</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/costos.css">
</head>
<body>

    <header>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand">
          <img src="img/LogoAgrocontrol.png" alt="Logo Agrocontrol" width="100" height="100" onerror="this.style.display='none'">
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="contenidoPrincipal.html">Inicio</a>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Vacas
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="Jersey.html">Jersey</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="Girolando.html">Girolando</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="Gyr.html">Gyr</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="simmental.html">Simmental</a></li>
              </ul>
            </li>

            <li class="nav-item">
          <a class="nav-link" href="Medicamentos.html">Medicamentos</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="insumos.html">Insumos</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="enfermedades.html">Enfermedades</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="Alertas y recordatorios.html">Recordatorios</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="control.html">Control</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="Costos.html">Costos</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="Perfilusuario.html">Perfil</a>
            </li>
          </ul>

          <!--  BOTN DESCARGAR APP (Alineado a la derecha) -->
      <div class="ms-auto">
        <button class="btn-descargar-app" data-bs-toggle="modal" data-bs-target="#modalQR">
          <span class="download-icon"></span>
          <span class="download-text">Descargar App</span>
        </button>
      </div>
       

          
        </div>
      </div>
    </nav>
  </header>

  <main class="container my-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="m-0" style="color:#1e7e34;">Costos</h2>
    <button class="btn btn-success rounded-pill" data-bs-toggle="modal" data-bs-target="#modalNuevoCosto">
      <i class="bi bi-plus-lg"></i> Nuevo costo
    </button>
  </div>

  <!-- FILTROS -->
 <div class="card mb-3" style="border-radius:14px;">
  <div class="card-body">
    
    <div class="d-flex flex-wrap gap-2 mb-3 filtros-fecha">
        <button id="filtro-dia" type="button" class="btn btn-outline-success">DA</button>
        <button id="filtro-semana" type="button" class="btn btn-outline-success">SEMANA</button>
        <button id="filtro-mes" type="button" class="btn btn-outline-success active">MES</button>
        <button id="filtro-ano" type="button" class="btn btn-outline-success">AO</button>

        <button id="btn-rango" class="btn btn-outline-success rounded-pill">
            <i class="bi bi-calendar-range"></i> Personalizado
        </button>
    </div>

    
    <div class="d-flex flex-wrap gap-2 justify-content-start"> 
      <div class="card p-2 text-center flex-grow-1" style="min-width:150px; border-radius:12px;">
        <div style="color:#dc3545; font-weight:700;">Gastos</div>
        <div id="totalGastos" style="font-size:20px; font-weight:700; color:#dc3545;">$0.00</div>
      </div>
      <div class="card p-2 text-center flex-grow-1" style="min-width:150px; border-radius:12px;">
        <div style="color:#1e7e34; font-weight:700;">Ingresos</div>
        <div id="totalIngresos" style="font-size:20px; font-weight:700; color:#1e7e34;">$0.00</div>
      </div>
    </div>
    
    <div class="mt-3">
      <small id="rangoLabel" class="text-muted">Filtro: Mes actual</small>
    </div>
  </div>
</div>

  <!-- GRAFICO Y TABLA -->
  <div class="row">
    <div class="col-lg-4 mb-3">
      <div class="card p-3" style="border-radius:12px; height:100%;">
        <canvas id="chartIngresosGastos" aria-label="Ingresos vs Gastos"></canvas>
        <small class="text-muted d-block mt-2">Comparaci贸n Ingresos vs Gastos</small>
      </div>
    </div>

    <div class="col-lg-8 mb-3">
      <div class="card" style="border-radius:12px;">
        <div class="card-body p-2">
          <div class="table-responsive">
            <table class="table table-hover align-middle mb-0" id="tablaCostos">
              <thead class="table-light">
                <tr>
                  <th>Tipo</th>
                  <th>Categor铆a</th>
                  <th>Nota</th>
                  <th>Fecha</th>
                  <th class="text-end">Monto</th>
                  <th class="text-center">Acciones</th>
                </tr>
              </thead>
              <tbody id="tbodyCostos">
                <!-- Filas din谩micas -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Nuevo / Editar costo -->
  <div class="modal fade" id="modalNuevoCosto" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="border-radius:14px;">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Nuevo costo</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <form id="formCosto">
            <input type="hidden" id="costoId" value="">
            <div class="mb-2">
              <label class="form-label">Tipo</label>
              <select id="inputTipo" class="form-select" required>
                <option value="gasto">Gasto</option>
                <option value="ingreso">Ingreso</option>
              </select>
            </div>
            <div class="mb-2">
              <label class="form-label">Categor铆a</label>
              <input id="inputCategoria" class="form-control" placeholder="Ej: Alimento, Veterinario" required>
            </div>
            <div class="mb-2">
              <label class="form-label">Monto</label>
              <input id="inputMonto" type="number" step="0.01" class="form-control" placeholder="0.00" required>
            </div>
            <div class="mb-2">
              <label class="form-label">Fecha</label>
              <input id="inputFecha" type="date" class="form-control" required>
            </div>
            <div class="mb-2">
              <label class="form-label">Nota</label>
              <textarea id="inputNota" class="form-control" rows="2" placeholder="Opcional"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button id="btnEliminar" type="button" class="btn btn-outline-danger me-auto d-none">Eliminar</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button id="btnGuardar" type="button" class="btn btn-success">Guardar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalConfirmarEliminar" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius:14px;">
      <div class="modal-header">
        <h5 class="modal-title">Confirmar eliminaci贸n</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        驴Deseas eliminar este registro?
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button id="confirmarEliminar" class="btn btn-danger">Eliminar</button>
      </div>
    </div>
  </div>
</div>

  <!-- Rango personalizado (bootstrap date inputs) -->
  <div class="modal fade" id="modalRango" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="border-radius:14px;">
        <div class="modal-header">
          <h5 class="modal-title">Seleccionar rango</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-2">
            <label class="form-label">Desde</label>
            <input id="rangoDesde" type="date" class="form-control">
          </div>
          <div class="mb-2">
            <label class="form-label">Hasta</label>
            <input id="rangoHasta" type="date" class="form-control">
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button id="btnAplicarRango" class="btn btn-success">Aplicar</button>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- MODAL QR CODE -->
<div class="modal fade" id="modalQR" tabindex="-1" aria-labelledby="modalQRLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content modal-qr">
      <div class="modal-header border-0">
        <h5 class="modal-title w-100 text-center" id="modalQRLabel">
           Descarga la App BoviGestf
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center p-4">
        <p class="mb-4">Escanea el c贸digo QR con tu dispositivo m贸vil</p>
        
        <!--  AQU VA TU CDIGO QR -->
        <div class="qr-container">
          <img id="qr-code-img" src="" alt="QR Code" class="qr-image">
        </div>

        <div class="download-info mt-4">
          <div class="info-badge">
            <span class="badge-icon"></span>
            <span class="badge-text">Android APK</span>
          </div>
          <p class="text-muted small mt-3 mb-0">
            O descarga directamente desde tu m贸vil:
          </p>
          <!-- BOTN DE DESCARGA DIRECTA -->
          <a id="btn-download-apk" href="#" class="btn btn-download-direct mt-2">
            <span>猬锔</span> Descargar APK
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const firebaseConfig = {
      apiKey: "AIzaSyAzonIFbhlOnnIs9xG9Lb4uBJHLrhCi3qU",
      authDomain: "web-y-movil-agroncontrol.firebaseapp.com",
      projectId: "web-y-movil-agroncontrol",
      storageBucket: "web-y-movil-agroncontrol.firebasestorage.app",
      messagingSenderId: "180502593551",
      appId: "1:180502593551:web:f4ae5111ac99ec70fa237a",
      measurementId: "G-BJ9G9WSKNY"
  };

  firebase.initializeApp(firebaseConfig);

    //  CONFIGURA TU ENLACE AQU
  const APK_URL = "https://drive.google.com/file/d/1AzI0q8QNbPIYP10eewEgUaiu184At9aA/view?usp=drive_link";
  
  // Actualizar bot贸n de descarga
  document.getElementById('btn-download-apk').href = APK_URL;
  
  // Generar QR din谩micamente
  const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(APK_URL)}`;
  document.getElementById('qr-code-img').src = qrApiUrl;
  
</script>

<script src="js/costos.js"></script>
    
</body>
</html>