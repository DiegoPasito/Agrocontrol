<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agrocontrol</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/Gyr.css">

</head>
<body>
 <header>

 <nav class="navbar navbar-expand-lg ">
  <div class="container-fluid ">

    <a class="navbar-brand" >
      <img src="img/Logo agrocontrol.png" alt="Bootstrap" width="100" height="100">
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">

         <li class="nav-item">
          <a class="nav-link" href="contenidoPrincipal.html" > Inicio </a>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Vacas
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="Jersey.html">Jersey</a></li>
            <li><hr class="dropdown-divider" ></li>
            <li><a class="dropdown-item" href="Girolando.html">Girolando</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="Gyr.html">Gyr</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="simmental.html">Simmental</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" >Medicamentos</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="Medicamento Jersey.html">Jersey</a></li>
            <li><hr class="dropdown-divider" ></li>
            <li><a class="dropdown-item" href="Medicamento Girolando.html">Girolando</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="Medicamento Gyr.html">Gyr</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="Medicamento Simmental.html">Simmental</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Insumos</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="enfermedades.html">Enfermedades</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="Alertas y recordatorios.html" > Alertas y Recordatorios </a>
        </li>

         <li class="nav-item">
          <a class="nav-link" href="control.html" > Control </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="Perfilusuario.html" > Perfil </a>
        </li>

      </ul>
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Buscar" aria-label="Search"/>
        <button class="btn btn-outline-success" type="submit">Buscar</button> 
      </form> <br>
    </div>
  </div>
 </nav>
  </header>

    <main class="container mt-4">
      <div class="text-center mb-5">
        <h2 style="color:#207729; font-weight:700;">üêÑ Perfil de la Vaca Gyr</h2>
        <p style="color:#2d7a35;">Raza tropical, resistente y base de la famosa Girolando ‚òÄÔ∏è</p>
        <hr style="width:60%; margin:auto; border:2px solid #36ac42;">
      </div>
      
      <!-- Secci√≥n principal -->
      <div class="card shadow-lg border-0 mb-4"
        style="border-radius:20px; background:linear-gradient(145deg, #a9eeb0, #a1e2a8);">
        <div class="row g-0 align-items-center">
          <div class="col-md-5">
            <img src="img/Gyr Imagen 4.webp" class="img-fluid rounded-start" alt="Vaca Gyr" style="border-radius:20px 0 0 20px;">
          </div>
          <div class="col-md-7">
            <div class="card-body">
              <h4 class="card-title fw-bold" style="color:#207729;">Raza Gyr</h4>
              <p class="card-text">
                <strong>Descripci√≥n:</strong> La Gyr es una raza cebuina originaria de la India üáÆüá≥, conocida por su
                resistencia al calor, longevidad y buena producci√≥n de leche en zonas tropicales.
                Es fundamental en programas de cruce como la <strong>Girolando (Gyr x Holstein)</strong>.
              </p>
              <ul class="list-unstyled">
                <li><strong>Uso principal:</strong> Producci√≥n lechera y cruzamientos.</li>
                <li><strong>Tama√±o promedio:</strong> 400‚Äì550 kg.</li>
                <li><strong>Color:</strong> Rojo, blanco moteado o gris.</li>
                <li><strong>Producci√≥n:</strong> 2.000‚Äì3.500 L/lactancia.</li>
                <li><strong>Grasa:</strong> 4.5‚Äì5%.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Alimentaci√≥n -->
      <div class="card shadow-sm border-0 mb-4"
        style="background-color:#a9eeb0; border-left:6px solid #36ac42; border-radius:15px;">
        <div class="card-body">
          <h5 style="color:#207729;">üå± Alimentaci√≥n</h5>
          <ul>
            <li><strong>Forrajes:</strong> Brachiaria, estrella africana, pasto guineo.</li>
            <li><strong>Conservados:</strong> Ensilaje de ma√≠z o ca√±a de az√∫car.</li>
            <li><strong>Leguminosas:</strong> Matarrat√≥n, bot√≥n de oro.</li>
            <li><strong>Requerimientos:</strong> Menos exigente que razas europeas, m√°s econ√≥mica de mantener.</li>
          </ul>
        </div>
      </div>
      
      <!-- Suplementos -->
      <div class="card shadow-sm border-0 mb-4"
        style="background-color:#a9eeb0; border-left:6px solid #36ac42; border-radius:15px;">
        <div class="card-body">
          <h5 style="color:#207729;">üß™ Suplementos</h5>
          <ul>
            <li><strong>Minerales:</strong> Calcio, f√≥sforo y magnesio.</li>
            <li><strong>Postparto:</strong> Energ√≠a adicional (propilenglicol, balanceados).</li>
            <li><strong>Producci√≥n:</strong> Suplementos proteicos y vitam√≠nicos para mejorar la calidad de la leche.</li>
          </ul>
        </div>
      </div>
      
      <!-- Manejo sanitario -->
      <div class="card shadow-sm border-0 mb-4"
        style="background-color:#a9eeb0; border-left:6px solid #36ac42; border-radius:15px;">
        <div class="card-body">
          <h5 style="color:#207729;">üöë Manejo sanitario</h5>
          <ul>
            <li><strong>Vacunas:</strong> Aftosa, brucelosis, clostridiosis, IBR, BVD y leptospira.</li>
            <li><strong>Par√°sitos:</strong> Control de garrapatas y moscas en climas tropicales.</li>
            <li><strong>Resistencia natural:</strong> Alta tolerancia al calor y enfermedades tropicales.</li>
          </ul>
        </div>
      </div>
      
      <!-- Reproducci√≥n -->
      <div class="card shadow-sm border-0 mb-4"
        style="background-color:#a9eeb0; border-left:6px solid #36ac42; border-radius:15px;">
        <div class="card-body">
          <h5 style="color:#207729;">üë∂ Reproducci√≥n</h5>
          <ul>
            <li><strong>Primer parto:</strong> 30‚Äì36 meses.</li>
            <li><strong>Intervalo entre partos:</strong> 13‚Äì15 meses.</li>
            <li><strong>Ventaja:</strong> Longevidad alta y excelente instinto maternal.</li>
          </ul>
        </div>
      </div>
      
      <!-- Ventajas y desventajas -->
      <div class="card shadow-sm border-0 mb-5"
        style="background-color:#a9eeb0; border-left:6px solid #36ac42; border-radius:15px;">
        <div class="card-body">
          <h5 style="color:#207729;">üìä Ventajas y desventajas</h5>
          <div class="row">
            <div class="col-md-6">
              <p class="fw-bold">Ventajas üåü</p>
              <ul>
                <li>Alta resistencia al calor, sequ√≠a y par√°sitos.</li>
                <li>Longevidad y rusticidad excepcionales.</li>
                <li>Leche con alto contenido graso.</li>
              </ul>
            </div>
            <div class="col-md-6">
              <p class="fw-bold">Desventajas ‚ö†Ô∏è</p>
              <ul>
                <li>Producci√≥n de leche m√°s baja que razas europeas.</li>
                <li>Madurez sexual tard√≠a.</li>
                <li>Temperamento menos d√≥cil.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <div class="text-center">
        <small style="color:#207729;">Actualizado: octubre de 2025 üïì</small>
      </div>
      
    <h2 class="mb-4 text-center">Mis Vacas Gyr</h2>
    <div id="tabla-gyr"></div>
  </main>

<!-- Modal Editar -->
  <div class="modal fade" id="editarModal" tabindex="-1" aria-labelledby="editarLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-warning text-dark">
          <h5 class="modal-title" id="editarLabel">Editar Vaca</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="formEditar">
            <input type="hidden" id="edit-id">

            <div class="mb-3">
              <label class="form-label">Nombre</label>
              <input type="text" class="form-control" id="edit-nombre" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Peso (kg)</label>
              <input type="number" class="form-control" id="edit-peso" step="any" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Edad (a√±os)</label>
              <input type="number" class="form-control" id="edit-edad" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Producci√≥n de leche (L/d√≠a)</label>
              <input type="number" class="form-control" id="edit-leche" step="any" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Lactando</label>
              <select class="form-select" id="edit-lactando">
                <option value="true">S√≠</option>
                <option value="false">No</option>
              </select>
            </div>

            <button type="submit" class="btn btn-success w-100">Guardar cambios</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Eliminar -->
  <div class="modal fade" id="eliminarModal" tabindex="-1" aria-labelledby="eliminarLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="eliminarLabel">Eliminar Vaca</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>¬øSeguro que deseas eliminar la vaca <strong id="nombreEliminar"></strong>?</p>
          <input type="hidden" id="delete-id">
          <button id="btnConfirmEliminar" class="btn btn-danger w-100">S√≠, eliminar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase y Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
    import { getFirestore, collection, query, where, getDocs, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAzonIFbhlOnnIs9xG9Lb4uBJHLrhCi3qU",
      authDomain: "web-y-movil-agroncontrol.firebaseapp.com",
      projectId: "web-y-movil-agroncontrol",
      storageBucket: "web-y-movil-agroncontrol.firebasestorage.app",
      messagingSenderId: "180502593551",
      appId: "1:180502593551:web:f4ae5111ac99ec70fa237a",
      measurementId: "G-BJ9G9WSKNY"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let usuarioId = null;

    function crearTabla(vacas) {
      if (vacas.length === 0) return "<p class='text-center text-muted'>No hay vacas Simmental registradas.</p>";
      let filas = vacas.map(v => `
        <tr>
          <td>${v.data.name}</td>
          <td>${v.data.weight} kg</td>
          <td>${v.data.age} a√±os</td>
          <td>${v.data.milkProduction ?? "-"} L</td>
          <td>${v.data.isLactating ? "S√≠" : "No"}</td>
          <td>
            <button class="btn btn-warning btn-sm me-1"
              data-bs-toggle="modal" data-bs-target="#editarModal"
              onclick="llenarFormulario('${v.id}','${v.data.name}','${v.data.weight}','${v.data.age}','${v.data.milkProduction ?? 0}','${v.data.isLactating}')">Editar</button>
            <button class="btn btn-danger btn-sm"
              data-bs-toggle="modal" data-bs-target="#eliminarModal"
              onclick="prepararEliminar('${v.id}','${v.data.name}')">Eliminar</button>
          </td>
        </tr>
      `).join("");
      return `<table class="table table-striped table-hover shadow rounded">
        <thead class="table-dark"><tr>
          <th>Nombre</th><th>Peso</th><th>Edad</th><th>Leche (L/d√≠a)</th><th>Lactando</th><th>Acciones</th>
        </tr></thead><tbody>${filas}</tbody></table>`;
    }

    async function cargarVacas(userId) {
      const q = query(collection(db, "users", userId, "cows"), where("breed", "==", "Gyr"));
      const querySnap = await getDocs(q);
      const vacas = querySnap.docs.map(docSnap => ({ id: docSnap.id, data: docSnap.data() }));
      document.getElementById("tabla-gyr").innerHTML = crearTabla(vacas);
    }

    window.llenarFormulario = function(id, nombre, peso, edad, leche, lactando) {
      document.getElementById("edit-id").value = id;
      document.getElementById("edit-nombre").value = nombre;
      document.getElementById("edit-peso").value = peso;
      document.getElementById("edit-edad").value = edad;
      document.getElementById("edit-leche").value = leche;
      document.getElementById("edit-lactando").value = lactando;
    };

    document.getElementById("formEditar").addEventListener("submit", async (e) => {
      e.preventDefault();
      const id = document.getElementById("edit-id").value;
      const nombre = document.getElementById("edit-nombre").value;
      const peso = parseFloat(document.getElementById("edit-peso").value);
      const edad = parseInt(document.getElementById("edit-edad").value);
      const leche = parseFloat(document.getElementById("edit-leche").value);
      const lactando = document.getElementById("edit-lactando").value === "true";
      await updateDoc(doc(db, "users", usuarioId, "cows", id), {
        name: nombre, weight: peso, age: edad, milkProduction: leche, isLactating: lactando
      });
      bootstrap.Modal.getInstance(document.getElementById("editarModal")).hide();
      cargarVacas(usuarioId);
    });

    window.prepararEliminar = function(id, nombre) {
      document.getElementById("delete-id").value = id;
      document.getElementById("nombreEliminar").innerText = nombre;
    };

    document.getElementById("btnConfirmEliminar").addEventListener("click", async () => {
      const id = document.getElementById("delete-id").value;
      await deleteDoc(doc(db, "users", usuarioId, "cows", id));
      bootstrap.Modal.getInstance(document.getElementById("eliminarModal")).hide();
      cargarVacas(usuarioId);
    });

    onAuthStateChanged(auth, (user) => {
      if (user) {
        usuarioId = user.uid;
        cargarVacas(usuarioId);
      } else {
        document.getElementById("tabla-gyr").innerHTML = "<p class='text-danger text-center'>Debes iniciar sesi√≥n para ver tus vacas.</p>";
      }
    });
  </script>


</body>
</html>